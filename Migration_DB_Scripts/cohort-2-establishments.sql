
-- 42 NDMS IDs
select id
from establishment
where nmdsid in ('I149087','I338116','I275445','C307782','E302906','E70709','F325118','F90206','F326717','B105527','B10061','B244811','B10266','H14159','J226329','G260465','J109433','J323989','D129187','D131148','H301826','H174268','F134367','D270265','G332039','I336693','F90545','G258595','J106120','C30134','E252431','G11736','H14334','I234058','H337555','D324655','I285465','C313126','J17467','J100098','H327419','C30725');

-- results in 42 establishment ids to use within in clause
(59, 248, 669, 187078, 215842, 162286, 2533, 2952, 200560, 225586, 3278, 60682, 5228, 12937, 232842, 10121, 10757, 216264, 12041, 17047, 177958, 136485, 15000, 20876, 233642, 17661, 168369, 40762, 205162, 154806, 42683, 45882, 196119, 85603, 181062, 218926, 196840, 144133, 215263, 170258, 217893, 231842)



-- tribal ids that failed to migrate - owing to location id foreign key
170258 -  Key (LocationID)=(1-102643017) is not present in table "location".

-- relexed the constraint
ALTER TABLE cqc."Establishment" DROP CONSTRAINT estloc_fk_two;